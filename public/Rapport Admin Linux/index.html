<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide de gestion d'un serveur Linux</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Administration Linux</h1>
    </header>
    <main>


        <!DOCTYPE html>
        <html lang="fr">
        <head>
            <meta charset="UTF-8">
            <title>Table des Mati√®res</title>
            <link rel="stylesheet" href="styles.css">
        </head>
        <body>
        
        <section id="Tale des mati√®res">
        <div class="table-of-contents">
            <h2>Table des Mati√®res</h2>
            <ul>
                <li><a href="#introduction">Introduction</a></li>
                <li><a href="#connexion">Connexion √† la Machine Virtuelle</a></li>
                <li><a href="#commandes">Bible des Lignes de Commandes Linux</a></li>
                <li><a href="#partition-system">Partitionnement et Syst√®me de Fichiers</a></li>
                <li><a href="#permissions">Utilisateurs et permissions</a></li>
                <li><a href="#accesSSH">Acc√®s avec clef SSH</a></li>
                <li><a href="#UFW">Uncomplicated Firewall</a></li>
                <li><a href="#Fail2ban">Fail2ban</a></li>
                <li><a href="#references">References</a></li>

            </ul>
        </div>
        
        </section>

            <section id="Introduction">
            <h2>Introduction</h2>
            <p>
              Ce rapport a √©t√© r√©dig√© dans le cadre du cours d'Administration Linux de l'ECAM (3e bachelier - g√©nie √©lectrique). Il constitue √† la fois une synth√®se personnelle sur la mati√®re abord√©e en classe et une partie int√©grante de l'√©valuation continue. Il t√©moigne des manipulations effectu√©es et des concepts assimil√©s tout au long du module.
               Dans un esprit d'am√©lioration continue, l'auteur reste ouvert √† toute suggestion et/ou correction de cette synth√®se et est contactable √† l'adresse suivante <a href="mailto:20342@ecam.be">20342@ecam.be</a>. 

            </p>
            <p>
              Dans un double objectif p√©dagogique et pratique, ce rapport a √©t√© r√©dig√© sous deux formats : un site web en HTML, CSS, et JavaScript pour concr√©tiser l'apprentissage en d√©veloppement web, et une version PDF pour une pr√©sentation plus formelle qui sera remise comme √©valuation. Pour profiter de toutes les fonctionnalit√©s et de la mise en page optimale, se r√©f√©rer √† la version web.
            </p>
            </section>
          
            <section id="connexion">
            <h2>Connexion √† la Machine Virtuelle</h2>
            <p>La machine virtuelle num√©ro 130, h√©berg√©e sur les serveurs de l'ECAM, est accessible √† distance via le protocole SSH qui permet une gestion s√©curis√©e du serveur √† distance. La connection se fait √† partir de PuTTY, un client de terminal SSH open source pour Windows OS.</p>
            <p>
                Le protocole SSH (Secure Shell) est une m√©thode standard pour s√©curiser les communications r√©seau. En utilisant SSH, vous pouvez acc√©der √† des machines distantes, ex√©cuter des commandes et d√©placer des fichiers, tout cela avec une s√©curit√© renforc√©e. Les donn√©es envoy√©es sur le r√©seau sont crypt√©es, ce qui emp√™che les √©coutes indiscr√®tes et les attaques potentielles.
            </p>
              
            <div class="image-container">
                <img src="illustations/Putty.png" alt="Interface Putty" class="responsive-image" />
                <img src="illustations/Login.png" alt="Interface de connexion" class="responsive-image" />
            </div>
            
            <p>Apr√®s avoir encod√© le Host name, le Port et le type de connexion, nous pouvons acc√©der √† ma machine virtuelle. Celle-ci demande un login et un password, initialement admin-3be et ECAMecam. Le password sera chang√© au moyen de la commande passwd et le nom d'utilisateurs sera remplac√© par Diego.</p>
        
            <p>
                Le nom de domaine fonctionne comme un pointeur vers une adresse IP sp√©cifique qui est l'identifiant num√©rique d'un serveur sur le r√©seau. Le syst√®me de noms de domaine (DNS) traduit ce nom (plus simple √† retenir) en une adresse IP que les ordinateurs peuvent comprendre.
            </p>
            <p>
                Dans l'exemple <code>pat.infolab.ecam.be</code>, nous avons une structure hi√©rarchique, <code>be</code> indique le domaine de premier niveau correspondant √† la Belgique, <code>ecam</code> est bien √©videment l'√©tablissement, <code>infolab</code> d√©signe le laboratoire d'informatique, et <code>pat</code> est le nom attribu√© √† un serveur en particulier.
            </p>
            
            <p>
                Le port est un identifiant num√©rique qui est utilis√© pour permettre √† plusieurs services r√©seau de fonctionner sur un seul serveur sans interf√©rence. Les ports les plus utilis√©s sont les ports <code>80</code> pour HTTP ou le port <code>443</code> pour HTTPS. Pour plus d'informations, se r√©f√©rer au cours d'introduction aux r√©saux.
            </p>
        
        
        </section>
        
            
        </section>
        

        </section>
        <section id="commandes">
            <h2>Bible des Lignes de Commandes Linux</h2>
            <h3>Auto-compl√©tion avec "Tab"</h3>
            <p>L'auto-compl√©tion est une fonctionnalit√© qui permet de compl√©ter automatiquement les commandes, options ou noms de fichiers en appuyant sur la touche "Tab".</p>
            <h3>Manuel (man)</h3>
            <p>Utilisez la commande <code>man</code> suivie du nom de la commande pour obtenir un manuel d√©taill√© sur son utilisation.</p>
            <h3>Mise √† jour</h3>
            <pre><code>apt-get update && apt-get upgrade -y</code><span class="copy-icon" onclick="copyToClipboard('apt-get update && apt-get upgrade -y')">üìã</span></pre>
            <ul>
                <li><code>apt-get update</code>: Met √† jour la liste des paquets.</li>
                <li><code>apt-get install [nom du paquet]</code>: Installe un paquet.</li>
                <li><code>apt-get upgrade -y</code>: Met √† niveau les paquets install√©s. Le flag -y confirme automatiquement toutes les invites.</li>
            </ul>
            <h3>Navigation dans l'Arborescence</h3>
            <ul>
                <li><code>pwd</code>: Affiche le r√©pertoire de travail actuel.</li>
                <li><code>cd</code>: Change le r√©pertoire de travail.</li>
                <li><code>cd ..</code>: Remonte au r√©pertoire parent.</li>
                <li><code>cd /chemin/vers/le/dossier</code>: Se d√©place vers le dossier sp√©cifi√©.</li>
            </ul>

            <h3>Lister le Contenu d‚Äôun Dossier</h3>
            <ul>
                <li><code>ls</code>: Liste le contenu du r√©pertoire.</li>
                <li><code>ls -l</code>: Affiche en format long.</li>
                <li><code>ls -a</code>: Inclut les fichiers cach√©s.</li>
            </ul>

            <h3>Cr√©ation de Dossiers et Fichiers</h3>
            <ul>
                <li><code>mkdir nom_du_dossier</code>: Cr√©e un nouveau dossier.</li>
                <li><code>touch nom_du_fichier</code>: Cr√©e un nouveau fichier vide.</li>
            </ul>

            <h3>Manipulation de Fichiers</h3>
            <ul>
                <li><code>mv</code>: D√©place ou renomme des fichiers/dossiers.</li>
                <li><code>cp</code>: Copie des fichiers/dossiers.</li>
            </ul>

            <h3>√âditer un Fichier</h3>
            <ul>
                <li><code>vi</code> ou <code>vim</code>: √âditeur de texte en mode console.</li>
                <li><code>nano</code>: on pr√©ferera cette commande car moins de raccourcis.</li>
            </ul>

            <h3>Afficher le Contenu d'un Fichier</h3>
            <ul>
                <li><code>cat nom_du_fichier</code>: Affiche le contenu complet.</li>
                <li><code>more nom_du_fichier</code>: Affiche le contenu page par page.</li>
                <li><code>head nom_du_fichier</code>: Affiche les premi√®res lignes.</li>
                <li><code>tail nom_du_fichier</code>: Affiche les derni√®res lignes.</li>
            </ul>

            <h3>Supprimer Fichiers et Dossiers</h3>
            <ul>
                <li><code>rm -r nom_du_fichier</code>: Supprime un fichier.</li>
                <li><code>rmdir nom_du_dossier</code>: Supprime un dossier (doit √™tre vide).</li>
            </ul>

            <h3>Encha√Ænement de Commandes</h3>
            <ul>
                <li><code>;</code>: S√©pare des commandes ex√©cut√©es successivement.</li>
                <li><code>&&</code>: Ex√©cute la seconde commande si la premi√®re est r√©ussie.</li>
                <li><code>||</code>: Ex√©cute la seconde commande si la premi√®re √©choue.</li>
            </ul>

            <h3>Bash Script</h3>
            <p>Combinez plusieurs commandes dans un fichier script pour automatiser des t√¢ches r√©p√©titives.</p>

            <h3>Autres Commandes Utiles</h3>
            <ul>
                <li><code>echo</code>: Affiche un message ou la valeur d'une variable.</li>
                <li><code>&gt;</code> et <code>&gt;&gt;</code>: Redirige la sortie d'une commande vers un fichier.</li>
                <li><code>read</code>: Attend une entr√©e de l'utilisateur.</li>
                <li><code>date</code>: Affiche la date et l‚Äôheure courantes.</li>
                <li><code>#</code>: Commence un commentaire.</li>
            </ul>

            <h3>Exercice Pratique 1</h3>
            <p>Cr√©ez un petit fichier test dans votre dossier personnel</p>
            <pre><code>touch testfile.txt</code><span class="copy-icon" onclick="copyToClipboard('touch testfile.txt')">üìã</span></pre>
            <p>Renommez le, d√©placez le dans un r√©pertoir ‚Äúmes_fichiers‚Äù et allez dans ce r√©pertoire en une seule commande!</p>
            <pre><code>mv testfile.txt newname.txt && mkdir -p mes_fichiers && mv newname.txt mes_fichiers/ && cd mes_fichiers</code><span class="copy-icon" onclick="copyToClipboard('mv testfile.txt newname.txt && mkdir -p mes_fichiers && mv newname.txt mes_fichiers/ && cd mes_fichiers')">üìã</span></pre>
            <p>Lisez le contenu du fichier sans l‚Äô√©diter</p>
            <pre><code>cat newname.txt</code><span class="copy-icon" onclick="copyToClipboard('cat newname.txt')">üìã</span></pre>
            <p>Supprimez le, remontez dans votre dossier personnel et supprimez le r√©pertoire ‚Äúmes_fichiers‚Äù en une seule commande!</p>
            <pre><code>rm newname.txt && cd .. && rmdir mes_fichiers</code><span class="copy-icon" onclick="copyToClipboard('rm newname.txt && cd .. && rmdir mes_fichiers')">üìã</span></pre>

            <h3>Exercice Pratique 2</h3>
            <p>√âcrivez un script qui demande votre nom, puis enregistre la date et l‚Äôheure actuelles dans un fichier chaque fois qu'il est ex√©cut√©.</p>
            <p>Ex√©cutez le script plusieurs fois, puis v√©rifiez le contenu du fichier pour voir les enregistrements de la date et de l‚Äôheure.</p>

            <h4>2.1 Cr√©ation du script</h4>
            <p>Cr√©ez un fichier nomm√© monscript.sh et ajoutez les commandes n√©cessaires pour qu'il puisse demander le nom de l'utilisateur et l'enregistrer dans un fichier log avec la date et l'heure actuelles.</p>
            <pre><code>echo '#!/bin/bash' > monscript.sh
echo 'echo "Quel est votre nom?"' >> monscript.sh
echo 'read nom' >> monscript.sh
echo 'echo "Bonjour $nom"' >> monscript.sh
echo 'echo "$nom a lanc√© le script le $(date)" >> log.txt' >> monscript.sh</code><span class="copy-icon" onclick="copyToClipboard('...')">üìã</span></pre>

            <h4>2.2 Rendre le script ex√©cutable</h4>
            <p>Changez les permissions du fichier pour le rendre ex√©cutable.</p>
            <pre><code>chmod +x monscript.sh</code><span class="copy-icon" onclick="copyToClipboard('chmod +x monscript.sh')">üìã</span></pre>

            <h4>2.3 Ex√©cution du script</h4>
            <p>Il vous demandera votre nom, vous saluera dans le terminal, et enregistrera votre nom avec la date et l'heure dans un fichier log.txt.</p>
            <pre><code>./monscript.sh</code><span class="copy-icon" onclick="copyToClipboard('./monscript.sh')">üìã</span></pre>

            <h4>2.4 Lecture du fichier log</h4>
            <pre><code>cat log.txt</code><span class="copy-icon" onclick="copyToClipboard('cat log.txt')">üìã</span></pre>
            <div class="centered-image-container">
                <img src="illustations/Script1.png" alt="resltat" class="centered-image" />
            </div>


            <h4>2.5 Eventuellement suppression du script et du fichier log</h4>
            <pre><code>rm monscript.sh
rm log.txt</code><span class="copy-icon" onclick="copyToClipboard('rm monscript.sh\nrm log.txt')">üìã</span></pre>

            <h3>Exercice pratique 3</h3>
            <p>Cr√©er un script de mise √† jour automatique √† 02h00 UTC</p>

            <h4>Cr√©ation et √©dition du script</h4>
            <pre><code>sudo nano /usr/local/bin/update_upgrade_script.sh</code><span class="copy-icon" onclick="copyToClipboard('sudo nano /usr/local/bin/update_upgrade_script.sh')">üìã</span></pre>

            <h4>Mise √† jour des listes de paquets et mise √† niveau en silence et enregistrement de la date et de l'heure dans le fichier log</h4>
            <pre><code>#!/bin/bash
sudo apt-get update -y > /dev/null 2>&1
sudo apt-get upgrade -y > /dev/null 2>&1
echo "$(date)" >> /var/log/update_upgrade.log</code><span class="copy-icon" onclick="copyToClipboard('...')">üìã</span></pre>

            <h4>Rendre le script ex√©cutable</h4>
            <pre><code>sudo chmod +x /usr/local/bin/update_upgrade_script.sh</code><span class="copy-icon" onclick="copyToClipboard('sudo chmod +x /usr/local/bin/update_upgrade_script.sh')">üìã</span></pre>

            <h4>Ouverture de crontab (en sudo pour avoir tous les droits pour les mises √† jour)</h4>
            <pre><code>sudo crontab -e</code><span class="copy-icon" onclick="copyToClipboard('sudo crontab -e')">üìã</span></pre>

            <h4>Execution √† 02h00 UTC tous les jours, pour obtenir la syntaxe ad√©quate cf crontab guru (site web)</h4>
            <pre><code>0 2 * * * /usr/local/bin/update_upgrade_script.sh
            </code><span class="copy-icon" onclick="copyToClipboard('0 2 * * * /usr/local/bin/update_upgrade_script.sh')">üìã</span></pre>
            <p> Dans l'ordre on trouve : <br>
                <strong>Minute :</strong> La minute de l'heure √† laquelle la commande doit s'ex√©cuter. Les valeurs possibles vont de 0 √† 59.<br>
                <strong>Heure :</strong> L'heure √† laquelle la commande doit s'ex√©cuter. Les valeurs possibles vont de 0 √† 23, o√π 0 repr√©sente minuit.<br>
                <strong>Jour du mois :</strong> Le jour du mois o√π la commande doit s'ex√©cuter. Les valeurs possibles vont de 1 √† 31.<br>
                <strong>Mois :</strong> Le mois de l'ann√©e pendant lequel la commande doit s'ex√©cuter. Les valeurs vont de 1 (janvier) √† 12 (d√©cembre).<br>
                <strong>Jour de la semaine :</strong> Le jour de la semaine o√π la commande doit s'ex√©cuter. Les valeurs vont de 0 (dimanche) √† 6 (samedi).<br>
                <strong>* :</strong> Un ast√©risque repr√©sente toutes les valeurs possibles pour ce champ. Par exemple, une ast√©risque dans le champ des heures signifie "√† chaque heure".
            </p>
              
            <p>Ex√©cution manuelle du script pour tester son fonctionnement :</p>
            <pre><code>sudo /usr/local/bin/update_upgrade_script.sh</code><span class="copy-icon" onclick="copyToClipboard('sudo /usr/local/bin/update_upgrade_script.sh')">üìã</span></pre>

            <h4>Ouverture du fichier log</h4>
            <pre><code>cat /var/log/update_upgrade.log</code><span class="copy-icon" onclick="copyToClipboard('cat /var/log/update_upgrade.log')">üìã</span></pre>
            <div class="centered-image-container">
                <img src="illustations/Log.png" alt="script" class="centered-image" />
            </div> 
            
            <div class="centered-image-container">
                <img src="illustations/Script2.png" alt="resultat" class="centered-image" />
            </div>

            <h4>Supression du fichier log</h4>
            <pre><code>sudo echo "" > /var/log/update_upgrade.log</code><span class="copy-icon" onclick='copyToClipboard("sudo echo \"\" > /var/log/update_upgrade.log")'>üìã</span></pre>



        </section>

        <section id="partition-system">
            <h2>Partitionnement et Syst√®me de Fichiers</h2>
            
            <h3>Aper√ßu</h3>
            <p>Le partitionnement et le syst√®me de fichiers sont deux composantes cruciales pour la gestion et l'organisation des donn√©es sur un disque dur. Le partitionnement r√©f√®re √† la division d'un disque dur en sections isol√©es, chacune fonctionnant comme une unit√© s√©par√©e. Le syst√®me de fichiers, quant √† lui, est la m√©thode utilis√©e pour stocker et organiser les fichiers sur une partition.</p>
        
            <h3>Partitionnement Manuel vs Automatique</h3>
            <p>Manuel : Il est parfois n√©cessaire d‚Äôopter pour un partitionnement manuel, surtout pour des configurations sp√©cifiques. Par exemple :</p>
            <ul>
                <li>/var : Contient les logs, partitionn√©e s√©par√©ment pour √©viter de saturer le disque.</li>
                <li>/usr : Utilis√© dans les machines avec de nombreux utilisateurs diff√©rents.</li>
                <li>/home : Pour avoir les dossiers personnels sur une autre partition.</li>
            </ul>
            <p>Le but est principalement de prot√©ger la racine /. La partition swap est souvent mentionn√©e, mais elle est principalement utile pour l'hibernation de la machine, un cas non typique pour un serveur.</p>
            <p>Automatique : Suffisant dans la majorit√© des cas et peut √™tre r√©vis√© ult√©rieurement selon les besoins sp√©cifiques.</p>
        
            <h3>Le Syst√®me de Fichier</h3>
            <p>Il d√©termine comment les donn√©es sont lues, √©crites, et organis√©es sur le disque. Diff√©rents syst√®mes de fichiers ont des caract√©ristiques et des avantages sp√©cifiques, influen√ßant la performance et la s√©curit√© des donn√©es.</p>
        
            <h3>La Hi√©rarchie des Fichiers</h3>
            <p>Le syst√®me de fichiers Linux est structur√© selon une hi√©rarchie bien d√©finie. Pour plus de d√©tails <a href="https://refspecs.linuxfoundation.org/FHS_3.0/fhs/index.html">Filesystem Hierarchy Standard</a>.</p>
            <ul>
                <li><code>/bin/</code> : contient des ex√©cutables binaires essentiels pour le d√©marrage du syst√®me et des commandes n√©cessaires pour l'utilisateur root et les autres utilisateurs.</li>
                <li><code>/boot/</code> : contient les fichiers n√©cessaires au d√©marrage du syst√®me, comme le noyau Linux, les images initrd et les fichiers de configuration du chargeur de d√©marrage.</li>
                <li><code>/dev/</code> : contient des fichiers de p√©riph√©riques qui repr√©sentent les p√©riph√©riques mat√©riels du syst√®me.</li>
                <li><code>/etc/</code> : contient des fichiers de configuration syst√®me et des scripts pour initialiser le syst√®me.</li>
                <li><code>/home/</code> : contient les r√©pertoires personnels des utilisateurs, o√π ils stockent leurs fichiers personnels.</li>
                <li><code>/lib/</code> et <code>/lib64/</code> : contiennent des biblioth√®ques partag√©es et des modules du noyau n√©cessaires au d√©marrage du syst√®me et √† l'ex√©cution des commandes binaires.</li>
                <li><code>/media/</code> : un point de montage pour les dispositifs de stockage amovibles, comme les cl√©s USB et les disques durs externes.</li>
                <li><code>/mnt/</code> : utilis√© pour monter les syst√®mes de fichiers temporaires.</li>
                <li><code>/opt/</code> : contient des logiciels et des add-ons optionnels qui ne font pas partie de l'installation standard.</li>
                <li><code>/proc/</code> : un syst√®me de fichiers virtuel qui fournit des informations sur les processus en cours d'ex√©cution et le syst√®me.</li>
                <li><code>/root/</code> : le r√©pertoire personnel de l'utilisateur root.</li>
                <li><code>/run/</code> : contient des informations sur le syst√®me depuis le d√©marrage.</li>
                <li><code>/sbin/</code> : contient des binaires syst√®me essentiels, principalement destin√©s √† √™tre utilis√©s par l'utilisateur root.</li>
                <li><code>/srv/</code> : contient des donn√©es sp√©cifiques au site qui sont servies par le syst√®me.</li>
                <li><code>/tmp/</code> : un r√©pertoire temporaire o√π les fichiers sont stock√©s temporairement.</li>
                <li><code>/usr/</code> : contient des binaires, des biblioth√®ques, de la documentation, etc., pour tous les programmes utilisateur.</li>
                <li><code>/var/</code> : contient des fichiers variables, comme les fichiers journaux et les bases de donn√©es.</li>
            </ul>
            
        
            <h3>LVM (Logical Volume Manager)</h3>
            <h4>Avantages</h4>
            <ul>
                <li>√âlimine les limitations souvent associ√©es aux partitions traditionnelles (primaire, √©tendue, etc.).</li>
                <li>Flexibilit√© dans la gestion des donn√©es.</li>
                <li>Permet de conserver de l'espace libre pour un ajout facile √† n‚Äôimporte quel volume.</li>
                <li>Le redimensionnement des volumes est presque sans risque.</li>
            </ul>
            
            <h4>Inconv√©nients</h4>
            <ul>
                <li>Si un volume physique √©choue, tous les volumes logiques qui l'utilisent sont perdus. Une solution consiste √† utiliser LVM sur des disques en RAID pour une s√©curit√© accrue.</li>
            </ul>
            
            <p>Pour plus d'informations <a href="https://www.linuxtricks.fr/wiki/lvm-sous-linux-volumes-logiques">LVM sous Linux.</a></p>
            
            
        </section>

        <section id="permissions">
            <h2>Utilisateurs et permissions</h2>
        
            <h3>1. Types d‚ÄôUtilisateurs :</h3>
            <ul>
                <li><strong>R√©gulier</strong> : Ils ont des droits d'acc√®s de base et se reconnaissent par <code>$</code> au niveau du prompt.</li>
                <li><strong>Root ou Superuser</strong> : Ils ont tous les droits et privil√®ges, identifi√©s par <code>#</code> au niveau du prompt.</li>
                <li><strong>Service</strong> : Associ√© √† une application sp√©cifique et non utilisable en console.</li>
            </ul>
        
            <h3>2. Principe d'Acc√®s :</h3>
            <ul>
                <li>Il est recommand√© de se connecter en tant qu'utilisateur r√©gulier et d'obtenir des droits root temporairement au besoin pour √©viter des actions accidentelles pouvant affecter le syst√®me.</li>
            </ul>
        
            <h3>3. Gestion des Utilisateurs et Groupes :</h3>
            <ul>
                <li>Les utilisateurs et groupes sont g√©r√©s √† l'aide de commandes comme <code>sudo adduser</code>, <code>sudo userdel</code>, <code>sudo addgroup</code>, et <code>sudo usermod</code>.</li>
            </ul>
        
                <h3>4. Permissions :</h3>
                <p>Elles sont d√©finies pour le propri√©taire, le groupe et les autres utilisateurs, cod√©es en binaire et contr√¥l√©es par les commandes <code>chmod</code> et <code>chown</code>.</p>
            
                <h4>Repr√©sentation symbolique:</h4>
                <ul>
                    <li><strong>r:</strong> read (lecture)</li>
                    <li><strong>w:</strong> write (√©criture)</li>
                    <li><strong>x:</strong> execute (ex√©cution)</li>
                </ul>
            
                <h4>Types d'utilisateurs pour lesquels les droits sont d√©finis :</h4>
                <ul>
                    <li>Propri√©taire (<strong>u: user</strong>)</li>
                    <li>Groupe (<strong>g: group</strong>)</li>
                    <li>Autres (<strong>o: other</strong>)</li>
                </ul>
            
                <h4>Repr√©sentation num√©rique/octal:</h4>
                <ul>
                    <li><strong>4</strong> correspond √† r (lecture)</li>
                    <li><strong>2</strong> correspond √† w (√©criture)</li>
                    <li><strong>1</strong> correspond √† x (ex√©cution)</li>
                </ul>
            
                <h4>Combinaison des droits :</h4>
                <ul>
                    <li><strong>rwx</strong> = 4 + 2 + 1 = 7</li>
                    <li><strong>rw-</strong> = 4 + 2 = 6</li>
                    <li><strong>r-x</strong> = 4 + 1 = 5</li>
                    <li><strong>r--</strong> = 4</li>
                </ul>


                <h4>5. ACL (Access Control Lists) :</h4>
                <p>Pour des permissions plus fines, installez <code>acl</code> et configurez les droits d'acc√®s pour plusieurs utilisateurs et groupes.</p>
                
                
                <h3>R√©solution des exercices :</h3>
                
                <h4>Exercice 1 : Cr√©ation d'Utilisateurs</h4>
                <p><strong>Cr√©er les utilisateurs Master (super utilisateur) et Padawan (r√©gulier) :</strong></p>
                <pre><code>sudo adduser master
sudo adduser padawan</code><span class="copy-icon" onclick="copyToClipboard('sudo adduser master\nsudo adduser padawan')">üìã</span></pre>
                
                <h4>Exercice 2 : Cr√©ation d‚Äôun Groupe</h4>
                <p><strong>Cr√©er un groupe "team" et ajouter les utilisateurs et root au groupe :</strong></p>
                <pre><code>sudo addgroup team
sudo usermod -a -G team root
sudo usermod -a -G team master
sudo usermod -a -G team padawan</code><span class="copy-icon" onclick="copyToClipboard('sudo addgroup team\nsudo usermod -a -G team root\nsudo usermod -a -G team master\nsudo usermod -a -G team padawan')">üìã</span></pre>
                <p>Ces lignes ajoutent les utilisateurs "root", "master" et "padawan" au groupe "team". L'option -a -G est utilis√©e pour ajouter les utilisateurs au groupe sans les retirer de leurs groupes existants. Cela permet de rassembler diff√©rents types d'utilisateurs au sein d'un m√™me groupe pour une gestion et des permissions communes.</p>
                
                <h4>Exercice 3 : Cr√©ation de R√©pertoires avec Permissions</h4>
                <p><strong>Cr√©er un dossier "share" avec des sous-dossiers pour "team", "master", et "padawan" et attribuer les permissions et propri√©taires appropri√©s :</strong></p>
                <pre><code>sudo mkdir -p /home/share/{team,master,padawan}
sudo chown master:team /home/share
sudo chmod 700 /home/share                    
sudo chown master:team /home/share/master
sudo chown padawan:team /home/share/padawan
sudo chmod 750 /home/share/master
sudo chmod 750 /home/share/padawan
sudo chmod 770 /home/share/team</code><span class="copy-icon" onclick="copyToClipboard('sudo mkdir -p /home/share/{team,master,padawan}\nsudo chown master:team /home/share/master\nsudo chown padawan:team /home/share/padawan\nsudo chmod 750 /home/share/master\nsudo chmod 750 /home/share/padawan\nsudo chmod 770 /home/share/team')">üìã</span></pre>
                <p>Cr√©e un r√©pertoire principal "share" et trois sous-r√©pertoires "team", "master" et "padawan" dans le r√©pertoire "/home". L'option -p est utilis√©e pour cr√©er des r√©pertoires parents si n√©cessaire.</p>
                <p>Change le propri√©taire et le groupe des r√©pertoires "master" et "padawan". "master:team" signifie que l'utilisateur "master" est le propri√©taire et "team" est le groupe propri√©taire.</p>
                
                <h5>Justification :</h5>

                <p><strong>Pour /home/share:</strong></p>
                <p>Droits : rwx --x ---<br>
                Num√©rique : 771</p>
                <p>Le propri√©taire (master) a des droits complets (rwx = 7)<br>
                Le groupe (team) peut traverser le r√©pertoire mais ne peut ni lire ni √©crire (--x = 1).<br>
                Les autres n'ont aucun droit (--- = 0)</p>



                <p><strong>Pour /home/share/team:</strong></p>
                <p>Droits : rwx rwx ---<br>
                Num√©rique : 771</p>
                <p>Le propri√©taire (master) a des droits complets (rwx = 7)<br>
                Le groupe (team) a √©galement des droits complets (rwx = 7)<br>
                Les autres n'ont aucun droit (--- = 0)</p>
                
                <p><strong>Pour /home/share/master:</strong></p>
                <p>Droits : rwx r-x ---<br>
                Num√©rique : 750</p>
                <p>Le propri√©taire (master) a des droits complets (rwx = 7)<br>
                Le groupe (team) peut lire et ex√©cuter mais ne peut pas √©crire (r-x = 5)<br>
                Les autres n'ont aucun droit (--- = 0)</p>
                
                <p><strong>Pour /home/share/padawan:</strong></p>
                <p>Droits : rwx r-x ---<br>
                Num√©rique : 750</p>
                <p>Le propri√©taire (padawan) a des droits complets (rwx = 7)<br>
                Le groupe (team) peut lire et ex√©cuter mais ne peut pas √©crire (r-x = 5)<br>
                Les autres n'ont aucun droit (--- = 0)</p>

                <div class="centered-image-container">
                    <img src="illustations/permissions.png" alt="permissions" class="centered-image" />
                </div>


                <h4>Exercice 4 : Access Control Lists (ACL)</h4>
                <p><strong>Installer ACL et configurer des permissions d√©taill√©es :</strong></p>
                <pre><code>sudo apt-get install acl
setfacl -m u:username:rwx /path/to/file</code><span class="copy-icon" onclick="copyToClipboard('sudo apt-get install acl\nsetfacl -m u:username:rwx /path/to/file')">üìã</span></pre>
                <p>Remplacez "username" par le nom d'utilisateur et "/path/to/file" par le chemin du fichier pour lequel vous souhaitez d√©finir l'ACL.</p>
                
                <h4>Exercice 5 : Cr√©er un Dossier de Backup</h4>
                <p><strong>Cr√©er un dossier "backup", assurez-vous qu'il soit en lecture seule pour tous sauf root et cr√©er un script pour le backup du dossier "share" :</strong></p>
                <pre><code>sudo mkdir /home/backup
sudo chmod 744 /home/backup</code><span class="copy-icon" onclick="copyToClipboard('sudo mkdir /home/backup\nsudo chmod 744 /home/backup')">üìã</span></pre>

                <p><strong>Pour /home/backup:</strong></p>
                <p>Droits : rwx r-- r--<br>
                Num√©rique : 744</p>
                <p>Le propri√©taire (padawan) a des droits complets (rwx = 7)<br>
                    Le propri√©taire (root) a des droits complets (rwx = 7)<br>
                    Le groupe et les autres peuvent lire le contenu du r√©pertoire (r-- = 4), mais ne peuvent ni √©crire ni ex√©cuter.<br>
                    Les permissions permettent √† root de modifier le r√©pertoire, tandis que les autres utilisateurs peuvent seulement voir ce qui est dans /home/backup, sans pouvoir y ajouter ou retirer des fichiers.<br>
                Les autres n'ont aucun droit (--- = 0)</p>

                <pre><code>#!/bin/bash
# D√©finir le chemin de sauvegarde
chemin_sauvegarde="/home/backup"
# D√©finir le chemin source
chemin_source="/home/share"
# Cr√©er un nom de fichier de sauvegarde avec la date
nom_fichier_sauvegarde="share-backup-$(date +%F).tar.gz"
# Cr√©er la sauvegarde en utilisant tar
tar -czf "${chemin_sauvegarde}/${nom_fichier_sauvegarde}" "${chemin_source}"
</code><span class="copy-icon" onclick="copyToClipboard('#!/bin/bash\n# D√©finir le chemin de sauvegarde\nchemin_sauvegarde=&quot;/home/backup&quot;\n# D√©finir le chemin source\nchemin_source=&quot;/home/share&quot;\n# Cr√©er un nom de fichier de sauvegarde avec la date\nnom_fichier_sauvegarde=&quot;share-backup-$(date +%F).tar.gz&quot;\n# Cr√©er la sauvegarde en utilisant tar\ntar -czf &quot;${chemin_sauvegarde}/${nom_fichier_sauvegarde}&quot; &quot;${chemin_source}&quot;')">üìã</span></pre>
                    
            </section>

            <section id="accesSSH">
            <h2>Acc√®s avec clef SSH</h2>
            <ol>
                <li>Utilisation de Puttygen pour g√©n√©rer une paire de cl√©s de 1024 bits
                <div class="centered-image-container">
                <img src="illustations/ClefSSH.png" alt="ClefSSH">
                </div>
                </li>
                <li>Sur le serveur distant, cr√©ation du r√©pertoire <code>~/.ssh</code> s'il n'existe pas d√©j√†
                <pre><code>mkdir -p ~/.ssh</code><span class="copy-icon" onclick="copyToClipboard('mkdir -p ~/.ssh')">üìã</span></pre>

                <pre><code>echo "copi√©_coll√©_de_la_publicKey_ci_dessus" &gt;&gt; ~/.ssh/authorized_keys</code><span class="copy-icon" onclick="copyToClipboard('echo &quot;copi√©_coll√©_de_la_publicKey_ci_dessus&quot; &gt;&gt; ~/.ssh/authorized_keys')">üìã</span></pre>
                    
                <li>Configuration des permissions pour le r√©pertoire <code>~/.ssh</code> et le fichier <code>~/.ssh/authorized_keys</code> et ajustement du propri√©taire des fichiers
                <pre><code>chmod 700 ~/.ssh
chmod 600 ~/.ssh/authorized_keys
chown $USER:$USER ~/.ssh -R</code><span class="copy-icon" onclick="copyToClipboard('chmod 700 ~/.ssh\nchmod 600 ~/.ssh/authorized_keys\nchown $USER:$USER ~/.ssh -R')">üìã</span></pre>
                </li>
                <li>Ajout de la cl√© priv√©e au profil PuTTY sous "Connection" &gt; "SSH" &gt; "Auth" &gt; "Credential" &gt; "Private key"
                <div class="centered-image-container">
                <img src="illustations/PuttyKey.png" alt="PuttyKey">
                </div>
                </li>
                <li>Ouverture de la session
                <div class="centered-image-container">
                <img src="illustations/KeyLog.png" alt="KeyLog">
                </div>
                </li>
            </ol>
            </section>

            <section id="UFW">
            <h2>UFW - Uncomplicated Firewall</h2>
            <p>UFW est un outil de configuration de pare-feu sous Linux.</p>
            <p>Un pare-feu, ou <em>firewall</em> en anglais, est un dispositif de s√©curit√© r√©seau qui surveille et contr√¥le le trafic entrant et sortant d'un r√©seau en fonction de r√®gles de s√©curit√© pr√©d√©finies. Un pare-feu peut √™tre mat√©riel, logiciel (le cas de UFW), ou une combinaison des deux.</p>
            <h3>Installation</h3>
            <pre><code>sudo apt install ufw</code><span class="copy-icon" onclick="copyToClipboard('sudo apt install ufw')">üìã</span></pre>
            <h3>Activation</h3>
            <pre><code>sudo ufw enable</code><span class="copy-icon" onclick="copyToClipboard('sudo ufw enable')">üìã</span></pre>
            
            <div class="centered-image-container">
                <img src="illustations/UFW.png" alt="UFW status" class="centered-image" />
            </div>

            <pre><code>sudo ufw status verbose</code><span class="copy-icon" onclick="copyToClipboard('sudo ufw status verbose')">üìã</span></pre>
            <h3>Commandes utiles</h3>
            <pre><code>sudo ufw allow 22 #autorise le port 22
sudo ufw allow ssh #autorise ssh
sudo ufw deny 25 #refuse le port 25
sudo ufw allow from 192.168.0.20 to any port 22 #autorise ssh seulement depuis ip XXX
sudo ufw deny from 192.168.0.20 #refuse trafic ip XXX
sudo ufw delete allow 22 #suppression de r√®gles
sudo ufw logging on #logs stock√©s dans /var/log/ufw.log</code><span class="copy-icon" onclick="copyToClipboard('sudo ufw allow 22\nsudo ufw allow ssh\nsudo ufw deny 25\nsudo ufw allow from 192.168.0.20 to any port 22\nsudo ufw deny from 192.168.0.20\nsudo ufw delete allow 22\nsudo ufw logging on')">üìã</span></pre>


                <div class="alert-box">
                  <h3>ATTENTION : Ne sciez pas la branche sur laquelle vous √™tes assis !</h2>
                  <p>Lors de la configuration de vos r√®gles UFW, soyez extr√™mement prudent pour ne pas bloquer votre acc√®s SSH. Si vous configurez mal une r√®gle et fermez le port SSH (par d√©faut 22), vous risquez de perdre l'acc√®s √† votre serveur et de vous retrouver dans l'incapacit√© de le g√©rer √† distance.</p>
                  <p>Avant de proc√©der √† des modifications, assurez-vous de :</p>
                  <ul>
                    <li>Conna√Ætre le port utilis√© par votre service SSH. Par d√©faut, il s'agit du port 22, mais il peut avoir √©t√© modifi√©.</li>
                    <li>Avoir une session SSH ouverte en parall√®le que vous ne fermerez pas. Cela vous permettra de revenir en arri√®re si les nouvelles r√®gles bloquent votre acc√®s.</li>
                    <li>Utiliser la commande <code>ufw allow</code> pour maintenir l'acc√®s au port SSH. Par exemple :</li>
                  </ul>
                  <pre><code>ufw allow 22/tcp</code><span class="copy-icon" onclick="copyToClipboard('ufw allow 22/tcp')">üìã</span></pre>
                </div>

            </section>

            <section id="Fail2ban">
                <h2>Fail2ban</h2>
                <p>Fail2Ban est un outil de s√©curit√© qui prot√®ge le serveur contre des tentatives d'intrusion r√©p√©t√©es. Lorsqu'il rep√®re plusieurs √©checs d'authentification, il peut bannir l'IP de l'attaquant. Ceci permet de se prot√©ger efficacement contre les attaques par force brute.</p>
                
                <h3>Installation</h3>
                <pre><code>sudo apt-get install fail2ban</code><span class="copy-icon" onclick="copyToClipboard('sudo apt-get install fail2ban')">üìã</span></pre>
                
                <h3>Commandes utiles</h3>
                <pre><code>sudo service fail2ban start
sudo service fail2ban stop
sudo service fail2ban restart
sudo systemctl enable fail2ban #active automatiquement au demarrage
</code><span class="copy-icon" onclick="copyToClipboard('sudo service fail2ban start\nsudo service fail2ban stop\nsudo service fail2ban restart')">üìã</span></pre>
                
                <pre><code>sudo fail2ban-client status
sudo fail2ban-client status ssh #pour voir les tentatives de connection</code><span class="copy-icon" onclick="copyToClipboard('sudo fail2ban-client status\nsudo fail2ban-client status ssh')">üìã</span></pre>
                
                <pre><code>sudo fail2ban-client set [JAIL_NAME] unbanip [IP_ADDRESS] #unban une IP</code><span class="copy-icon" onclick="copyToClipboard('sudo fail2ban-client set [JAIL_NAME] unbanip [IP_ADDRESS]')">üìã</span></pre>
                
                <pre><code>sudo service fail2ban stop #arret et desinstallation
sudo systemctl disable fail2ban
sudo apt-get purge fail2ban</code><span class="copy-icon" onclick="copyToClipboard('sudo service fail2ban stop\nsudo systemctl disable fail2ban\nsudo apt-get purge fail2ban')">üìã</span></pre>
                
                <h3>Application : protection du port SSH</h3>
                <p>Copier le fichier de configuration principal:</p>
                <pre><code>sudo cp /etc/fail2ban/fail2ban.conf /etc/fail2ban/fail2ban.local</code><span class="copy-icon" onclick="copyToClipboard('sudo cp /etc/fail2ban/fail2ban.conf /etc/fail2ban/fail2ban.local')">üìã</span></pre>
                
                <p>Copier le fichier jail :</p>
                <pre><code>sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local</code><span class="copy-icon" onclick="copyToClipboard('sudo cp /etc/fail2ban/jail.conf /etc/fail2ban/jail.local')">üìã</span></pre>
                
                <p>Ouvrir le fichier jail.local pour le modifier :</p>
                <pre><code>sudo nano /etc/fail2ban/jail.local</code><span class="copy-icon" onclick="copyToClipboard('sudo nano /etc/fail2ban/jail.local')">üìã</span></pre>
                
                <p>Contenu du fichier jail (exemples):</p>
                <pre><code>[ssh]
enabled  = true  # Active la surveillance pour SSH.
port     = ssh   # Port que SSH utilise (par d√©faut c'est 22).
filter   = sshd  # Motif √† rechercher dans les logs (utilise le filtre sshd).
logpath  = /var/log/auth.log  # Fichier de log √† surveiller.
maxretry = 3     # Le nombre d'√©checs avant bannissement.
bantime  = 3600  # Dur√©e (s) pendant laquelle l'IP sera bannie (ici 1 heure).</code></pre>
                    
<div class="centered-image-container">
    <img src="illustations/fail2ban_sshd.png" alt="fal2ban sshd" class="centered-image" />
</div>

                <p>D√©marrer Fail2ban</p>
                <pre><code>sudo service fail2ban start</code><span class="copy-icon" onclick="copyToClipboard('sudo service fail2ban start')">üìã</span></pre>
                
                <p>Assurer le d√©marrage automatique</p>
                <pre><code>sudo systemctl enable fail2ban</code><span class="copy-icon" onclick="copyToClipboard('sudo systemctl enable fail2ban')">üìã</span></pre>
                
                <p>Eventuellement v√©rifier le status</p>
                <pre><code>sudo fail2ban-client status ssh</code><span class="copy-icon" onclick="copyToClipboard('sudo fail2ban-client status ssh')">üìã</span></pre>
              
                <h4>test :</h4>
                <p>En mettant un bantime tr√®s court on peut tester la protection en se faisant banir nous-m√™me (ici avec un maxtetry=5 et bantime=60)</p>
    
                <div class="centered-image-container">
                    <img src="illustations/Fail.png" alt="fail2ban jail" class="centered-image" />
                </div>


            </section>

            <section>
            <h2>Conclusion</h2>
                <p>Ce rapport du cours d'administration linux reprend les diff√©rentes manipulations execut√©es ainsi que leur explication d√©tail√©e.
                    Nous avons abord√© divers sujets, tels que la gestion des lignes de commande Linux, le partitionnement du syst√®me de fichiers, la configuration des utilisateurs et des permissions, l'acc√®s s√©curis√© via SSH, la mise en place du pare-feu UFW et la s√©curit√© renforc√©e avec Fail2ban.
                    Ces connaissances constituent un point de d√©part de l'int√©r√™t pour la gestion de serveurs. La prochaine √©tape consistera √† construire son propre serveur et √† y h√©berger un site web personnel.</p>
            </section>

              

              <section id="references">
                <h2>R√©f√©rences</h2>
                <ul>
                  <li><a href="https://linux.goffinet.org/administration/le-shell/la-ligne-de-commande/" target="_blank">Le shell - La ligne de commande</a></li>
                  <li><a href="https://linux.goffinet.org/administration/le-shell/premier-script-shell" target="_blank">Premier Script Shell</a></li>
                  <li><a href="https://linuxhint.com/30_bash_script_examples" target="_blank">30 Bash Script Examples</a></li>
                  <li><a href="https://www.linux.com/training-tutorials/writing-simple-bash-script" target="_blank">Writing a Simple Bash Script</a></li>
                  <li><a href="https://www.oreilly.com/library/view/bash-cookbook/0596526784/ch15s14.html" target="_blank">Bash Cookbook</a></li>
                  <li><a href="https://helpdeskgeek.com/linux-tips/shell-script-backup-directory-linux" target="_blank">Shell Script to Backup Directory on Linux</a></li>
                  <li><a href="https://crontab.guru/" target="_blank">Crontab Guru</a></li>
                  <li><a href="https://doc.ubuntu-fr.org/permissions" target="_blank">Doc Ubuntu-Fr Permissions</a></li>
                  <li><a href="https://www.ssh.com/academy/ssh/putty/windows/puttygen" target="_blank">Generate a key pair with puttygen.exe</a></li>
                  <li><a href="https://wiki.ubuntu.com/UncomplicatedFirewall" target="_blank">Ubuntu wiki Uncomplicated Firewall</a></li>
                  <li><a href="https://doc.ubuntu-fr.org/ufw" target="_blank">Doc Ubuntu-Fr UFW</a></li>
                  <li><a href="https://doc.ubuntu-fr.org/fail2ban" target="_blank">Doc Ubuntu-Fr Fail2ban</a></li>
                  <li><a href="https://www.youtube.com/watch?v=OekaaLmwttc&list=PLjwdMgw5TTLUnvhOKLcpCG8ORQsfE7uB4&index=3" target="_blank">Mise en place d'un serveur web - Commandes de base (video)</a></li>
                  <li><a href="https://www.youtube.com/watch?v=lXOdDal6qos&list=PLjwdMgw5TTLUnvhOKLcpCG8ORQsfE7uB4&index=5" target="_blank">Mise en place d'un serveur web - SSH (video)</a></li>
                  <li><a href="https://www.youtube.com/watch?v=-rmK50PbqCY">Mise en place d'un serveur web - Fail2ban (video)</a></li>
                
                  
                </ul>
              </section>
              
              
        
        
    </main>
    <footer>
        <p>2023 ¬© Diego de Radigu√®s</p>
    </footer>
    <script src="script.js"></script>
</body>
</html>
